<p-card class="w-full">
    <p class="flex align-items-center">
        <strong>{{ 'StudyManagement.Personnel.Responsible Organization' | translate }}</strong>
        <app-tooltip class="ml-2" message="StudyManagement.ResponsibleOrganizationTooltip"></app-tooltip>
    </p>
    <p-dropdown
            [options]="organizationList"
            optionLabel="name"
            optionValue="organizationId"
            [style]="{ 'minWidth': '100%', 'margin-bottom': '1rem' }"
            placeholder="{{ 'StudyManagement.Personnel.Select an organization' | translate }}"
            (onChange)="selectAnOrganization($event.value)">
    </p-dropdown>

    <p *ngIf="!formDisabled" class="flex align-items-center">
        <strong>{{ 'StudyManagement.Personnel.Population' | translate }}</strong>
        <app-tooltip class="ml-2" message="StudyManagement.PopulationTooltip"></app-tooltip>
    </p>
    <p-dropdown
            [options]="populationList"
            optionLabel="populationUrl"
            optionValue="populationId"
            [(ngModel)]="selectedPopulationId"
            [style]="{ 'minWidth': '100%', 'margin-bottom': '1rem' }"
            placeholder="{{ 'StudyManagement.Personnel.Select a Population' | translate }}">
    </p-dropdown>

    <p *ngIf="!formDisabled" class="flex align-items-center">
        <strong>{{ 'StudyManagement.Personnel.Personnel' | translate }}</strong>
    </p>
    <div *ngIf="!formDisabled" class="personnel-table">
        <table class="w-full">
            <thead>
            <tr>
                <th>{{ 'Name' | translate }}</th>
                <th>{{ 'Surname' | translate }}</th>
                <th>{{ 'Roles' | translate }}</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let personnel of personnelList">
                <td>{{ personnel.firstName }}</td>
                <td>{{ personnel.lastName }}</td>
                <td>
                    <div class="roles-checkboxes">
                        <p-checkbox
                                *ngFor="let role of roles"
                                [label]="role.name"
                                [value]="role.value"
                                [binary]="true"
                                [ngModel]="personnelRoleMap.get(personnel.personId)?.includes(role.value)"
                                (ngModelChange)="onRoleChange(personnel, role.value, $event)">
                        </p-checkbox>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="flex justify-content-end mt-3">
        <button pButton pRipple
                type="button"
                label="{{ 'Save' | translate }}"
                class="p-button-raised"
                (click)="save()"
                [disabled]="personnelRoleMap.size === 0">
        </button>
    </div>
</p-card>